<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>CRUD de Inmobiliaria con Firebase y Bootstrap</title>
    <!-- Agrega los estilos de Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Agrega estilos adicionales si es necesario -->
    <style>
        body {
            padding: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>CRUD de Inmobiliaria con Firebase y Bootstrap</h2>

    <!-- Formulario para agregar una nueva propiedad -->
    <form id="formulario">
        <div class="form-group">
            <label for="propiedad">Propiedad:</label>
            <input type="text" class="form-control" id="propiedad" required>
        </div>
        <div class="form-group">
            <label for="ubicacion">Ubicación:</label>
            <input type="text" class="form-control" id="ubicacion" required>
        </div>
        <div class="form-group">
            <label for="precio">Precio:</label>
            <input type="number" class="form-control" id="precio" required>
        </div>
        <button type="button" class="btn btn-primary" onclick="agregarPropiedad()">Agregar Propiedad</button>
    </form>

    <hr>

    <!-- Tabla para mostrar y manipular propiedades -->
    <table class="table">
        <thead>
        <tr>
            <th>ID</th>
            <th>Propiedad</th>
            <th>Ubicación</th>
            <th>Precio</th>
            <th>Acciones</th>
        </tr>
        </thead>
        <tbody id="tabla-body">
        <!-- Aquí se mostrarán las propiedades -->
        </tbody>
    </table>
</div>

<!-- Agrega los scripts de Bootstrap, jQuery y Firebase -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Agrega la biblioteca de Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js"></script>

<!-- Configuración e inicialización de Firebase -->
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBB4VLEuWx4O57s4dfu9ii0BWLWJT33x58",
        authDomain: "proyectofari.firebaseapp.com",
        databaseURL: "https://proyectofari-default-rtdb.firebaseio.com",
        projectId: "proyectofari",
        storageBucket: "proyectofari.appspot.com",
        messagingSenderId: "538414020531",
        appId: "1:538414020531:web:08051bd59c98626d6a3dc6"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const propiedadesRef = database.ref('propiedades');

    let idContador = 1;

    // Leer datos de Firebase al cargar la página
    propiedadesRef.on('value', (snapshot) => {
        document.getElementById('tabla-body').innerHTML = '';
        snapshot.forEach((childSnapshot) => {
            const propiedad = childSnapshot.val();
            agregarFila(propiedad.id, propiedad.propiedad, propiedad.ubicacion, propiedad.precio);
            idContador = Math.max(idContador, propiedad.id + 1);
        });
    });

    function agregarPropiedad() {
        const propiedad = document.getElementById('propiedad').value;
        const ubicacion = document.getElementById('ubicacion').value;
        const precio = document.getElementById('precio').value;

        if (propiedad.trim() !== '' && ubicacion.trim() !== '' && precio.trim() !== '') {
            const nuevaPropiedad = {
                id: idContador,
                propiedad: propiedad,
                ubicacion: ubicacion,
                precio: precio
            };

            // Agregar a Firebase
            propiedadesRef.push(nuevaPropiedad);

            // Incrementar el contador de IDs
            idContador++;

            // Limpiar los campos después de agregar
            document.getElementById('propiedad').value = '';
            document.getElementById('ubicacion').value = '';
            document.getElementById('precio').value = '';
        } else {
            alert('Por favor, complete todos los campos.');
        }
    }

    function agregarFila(id, propiedad, ubicacion, precio) {
        const fila = `<tr id="fila-${id}">
                        <td>${id}</td>
                        <td>${propiedad}</td>
                        <td>${ubicacion}</td>
                        <td>${precio}</td>
                        <td>
                            <button type="button" class="btn btn-warning btn-sm" onclick="editarPropiedad(${id})">Editar</button>
                            <button type="button" class="btn btn-danger btn-sm" onclick="eliminarPropiedad(${id})">Eliminar</button>
                        </td>
                      </tr>`;

        document.getElementById('tabla-body').innerHTML += fila;
    }

    function editarPropiedad(id) {
        const propiedadActual = document.getElementById(`fila-${id}`).children[1].innerText;
        const ubicacionActual = document.getElementById(`fila-${id}`).children[2].innerText;
        const precioActual = document.getElementById(`fila-${id}`).children[3].innerText;

        const nuevaPropiedad = prompt('Editar propiedad:', propiedadActual);
        const nuevaUbicacion = prompt('Editar ubicación:', ubicacionActual);
        const nuevoPrecio = prompt('Editar precio:', precioActual);

        if (nuevaPropiedad !== null && nuevaUbicacion !== null && nuevoPrecio !== null) {
            const propiedadEditada = {
                id: id,
                propiedad: nuevaPropiedad,
                ubicacion: nuevaUbicacion,
                precio: nuevoPrecio
            };

            // Actualizar en Firebase
            propiedadesRef.child(id).set(propiedadEditada);
        }
    }

    function eliminarPropiedad(id) {
        const confirmacion = confirm('¿Seguro que desea eliminar esta propiedad?');

        if (confirmacion) {
            // Eliminar en Firebase
            propiedadesRef.child(id).remove();
        }
    }
</script>

</body>
</html
